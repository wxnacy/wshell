#!/usr/bin/env bash

VERSION=6.3.0

OS=${0/%install\/es/system\/check}
OSS=""
if [ -f $OS ];then
    TMP=`${OS}`
    OSS=($TMP)
else
    OS=`curl -L https://raw.githubusercontent.com/wxnacy/wshell/master/bin/system/check | bash`
    OSS=(${OS})
fi
SYS=${OSS[0]}
VER=${OSS[1]}

if [ ! `command -v java` ];then
    IJ=${0/%install\/es/java\/install}
    if [ -f $IJ ];then
        `${IJ}`
    else
        curl -L https://raw.githubusercontent.com/wxnacy/wshell/master/bin/java/install | bash
    fi

fi


if [ $SYS == 'ubuntu' ];then
    wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
    sudo apt-get install apt-transport-https
    echo "deb https://artifacts.elastic.co/packages/6.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-6.x.list
    sudo apt update && sudo apt install elasticsearch
elif [ $SYS == 'centos' ];then
    sudo rpm -ivh https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-${VERSION}.rpm
    sudo systemctl daemon-reload
    sudo systemctl enable elasticsearch.service
    sudo systemctl start elasticsearch.service
fi
